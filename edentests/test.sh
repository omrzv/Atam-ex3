# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢤⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠹⢷⣤⣀⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠉⠛⢶⣄⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢤⣌⣻⣦⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠸⣧⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠛⢶⣄⡀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠘⣷⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠛⢦⣄⡀⠀⠀⠀⠀
# ⠀⠀⠈⢿⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠙⠷⣄⠀⠀
# ⠀⠀⠀⠈⣧⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⡇⠀
# ⠀⠀⠀⠀⢸⡆⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⡤⠔⣲⠟⠋⠙⠒⠦⣤⣀⡀⠀⠀⠚⣷⡀
# ⠀⠀⠀⠀⠀⣷⠀⠀⠀⠀⠀⠀⠀⠀⠈⢁⣠⠞⠁⠀⠀⠀⠀⠀⠀⠻⣄⠀⠀⢰⠋⢧
# ⠀⠀⠀⠀⠀⢹⡇⠀⠀⠀⠀⠀⠀⠐⢚⡉⢹⠀⠀⠀⠀⠀⠀⠀⠀⢀⣼⠗⠦⣬⣷⠟
# ⠀⠀⠀⠀⠀⠘⣷⠀⠀⠀⠀⠀⠀⠀⠀⢀⣹⣧⣤⣀⡀⠀⣀⣤⡴⣏⠀⠀⢰⡿⠁⠀
# ⠀⠀⠀⠀⠀⠀⠹⣷⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠻⡟⠉⠀⠀⠀⠀⣰⡞⠁⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠙⢯⣝⠲⠦⣤⣄⣀⠀⠀⠀⠀⠀⠀⠁⠀⠀⢀⣤⠾⠋⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠻⣦⣀⠈⠉⠛⠓⠶⢤⣀⣧⣠⡴⠞⠋⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⡟⣷⣄⠀⠀⠀⠀⠈⢻⣧⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢱⡸⡏⠳⣄⠀⠀⠀⠀⠉⠳⣄⡀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢣⠘⢦⠈⠻⣤⡀⠀⠀⠀⠈⠳⣄⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⣧⡈⠳⡄⠈⠛⢦⣀⠀⠀⠀⠛⢷⣄⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠸⣷⡤⠟⢦⡀⠀⠙⣷⢦⣀⠀⠀⠙⢷⡀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⢷⡀⠀⢹⡄⠙⢷⣦⣄⣠⡇⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⢿⣆⢀⡇⠀⠀⠉⠛⠋⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠛⠋⠁⠀⠀⠀⠀⠀⠀⠀⠀
# Tests by Eden Yosef
# https://github.com/Eden998/ATAM_tests

gcc -g hw3_part1.c -o test.out

# Test the symbol foo

result=$(./test.out foo verySecretProgram | grep "foo")
expected="foo will be loaded to 0x401b70"

if [ "$result" = "$expected" ]; then
    echo "Test 1 passed"
else
    echo "Test 1 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol checkPassword

result=$(./test.out checkPassword verySecretProgram | grep "checkPassword")
expected="checkPassword will be loaded to 0x401ca0"

if [ "$result" = "$expected" ]; then
    echo "Test 2 passed"
else
    echo "Test 2 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol checkPasswordAux

result=$(./test.out checkPasswordAux verySecretProgram | grep "checkPasswordAux")
expected="checkPasswordAux will be loaded to 0x401c50"

if [ "$result" = "$expected" ]; then
    echo "Test 3 passed"
else
    echo "Test 3 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol unused

result=$(./test.out unused verySecretProgram | grep "unused")
expected="unused will be loaded to 0x4006e0"

if [ "$result" = "$expected" ]; then
    echo "Test 4 passed"
else
    echo "Test 4 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol unused2

result=$(./test.out unused2 verySecretProgram | grep "unused2")
expected="unused2 will be loaded to 0x400630"

if [ "$result" = "$expected" ]; then
    echo "Test 5 passed"
else
    echo "Test 5 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol main

result=$(./test.out main verySecretProgram | grep "main")
expected="main will be loaded to 0x4004e0"

if [ "$result" = "$expected" ]; then
    echo "Test 6 passed"
else
    echo "Test 6 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol _start

result=$(./test.out _start verySecretProgram | grep "_start")
expected="_start will be loaded to 0x400540"

if [ "$result" = "$expected" ]; then
    echo "Test 7 passed"
else
    echo "Test 7 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol __libc_csu_init

result=$(./test.out __libc_csu_init verySecretProgram | grep "__libc_csu_init")
expected="__libc_csu_init will be loaded to 0x401d40"

if [ "$result" = "$expected" ]; then
    echo "Test 8 passed"
else
    echo "Test 8 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol __libc_csu_fini

result=$(./test.out __libc_csu_fini verySecretProgram | grep "__libc_csu_fini")
expected="__libc_csu_fini will be loaded to 0x401db0"

if [ "$result" = "$expected" ]; then
    echo "Test 9 passed"
else
    echo "Test 9 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol _fini

result=$(./test.out _fini verySecretProgram | grep "_fini")
expected="_fini will be loaded to 0x401db4"

if [ "$result" = "$expected" ]; then
    echo "Test 10 passed"
else
    echo "Test 10 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol _IO_stdin_used

result=$(./test.out _IO_stdin_used verySecretProgram | grep "_IO_stdin_used")
expected="_IO_stdin_used will be loaded to 0x401dc0"

if [ "$result" = "$expected" ]; then
    echo "Test 11 passed"
else
    echo "Test 11 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol _init

result=$(./test.out _init verySecretProgram | grep "_init")
expected="_init will be loaded to 0x400480"

if [ "$result" = "$expected" ]; then
    echo "Test 12 passed"
else
    echo "Test 12 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol _dl_relocate_static_pie

result=$(./test.out _dl_relocate_static_pie verySecretProgram | grep "_dl_relocate_static_pie")
expected="_dl_relocate_static_pie will be loaded to 0x400570"

if [ "$result" = "$expected" ]; then
    echo "Test 13 passed"
else
    echo "Test 13 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol __TMC_END__

result=$(./test.out __TMC_END__ verySecretProgram | grep "__TMC_END__")
expected="__TMC_END__ will be loaded to 0x603050"

if [ "$result" = "$expected" ]; then
    echo "Test 14 passed"
else
    echo "Test 14 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol __bss_start

result=$(./test.out __bss_start verySecretProgram | grep "__bss_start")
expected="__bss_start will be loaded to 0x60304a"

if [ "$result" = "$expected" ]; then
    echo "Test 15 passed"
else
    echo "Test 15 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol _edata

result=$(./test.out _edata verySecretProgram | grep "_edata")
expected="_edata will be loaded to 0x60304a"

if [ "$result" = "$expected" ]; then
    echo "Test 16 passed"
else
    echo "Test 16 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol __data_start

result=$(./test.out __data_start verySecretProgram | grep "__data_start")
expected="__data_start will be loaded to 0x603030"

if [ "$result" = "$expected" ]; then
    echo "Test 17 passed"
else
    echo "Test 17 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol __dso_handle

result=$(./test.out __dso_handle verySecretProgram | grep "__dso_handle")
expected="__dso_handle will be loaded to 0x603038"

if [ "$result" = "$expected" ]; then
    echo "Test 18 passed"
else
    echo "Test 18 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol _end

result=$(./test.out _end verySecretProgram | grep "_end")
expected="_end will be loaded to 0x603050"

if [ "$result" = "$expected" ]; then
    echo "Test 19 passed"
else
    echo "Test 19 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi


# Test the symbol arr
result=$(./test.out arr verySecretProgram | grep "arr")
expected="arr will be loaded to 0x603048"

if [ "$result" = "$expected" ]; then
    echo "Test 20 passed"
else
    echo "Test 20 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol hw3.c

result=$(./test.out hw3.c verySecretProgram | grep "hw3.c")
expected="hw3.c is not a global symbol! :("

if [ "$result" = "$expected" ]; then
    echo "Test 21 passed"
else
    echo "Test 21 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol crtstuff.c

result=$(./test.out crtstuff.c verySecretProgram | grep "crtstuff.c")
expected="crtstuff.c is not a global symbol! :("

if [ "$result" = "$expected" ]; then
    echo "Test 22 passed"
else
    echo "Test 22 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol deregister_tm_clones

result=$(./test.out deregister_tm_clones verySecretProgram | grep "deregister_tm_clones")
expected="deregister_tm_clones is not a global symbol! :("

if [ "$result" = "$expected" ]; then
    echo "Test 23 passed"
else
    echo "Test 23 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol register_tm_clones

result=$(./test.out register_tm_clones verySecretProgram | grep "register_tm_clones")
expected="register_tm_clones is not a global symbol! :("

if [ "$result" = "$expected" ]; then
    echo "Test 24 passed"
else
    echo "Test 24 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol __do_global_dtors_aux

result=$(./test.out __do_global_dtors_aux verySecretProgram | grep "__do_global_dtors_aux")
expected="__do_global_dtors_aux is not a global symbol! :("

if [ "$result" = "$expected" ]; then
    echo "Test 25 passed"
else
    echo "Test 25 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol completed.7697

result=$(./test.out completed.7697 verySecretProgram | grep "completed.7697")
expected="completed.7697 is not a global symbol! :("

if [ "$result" = "$expected" ]; then
    echo "Test 26 passed"
else
    echo "Test 26 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol __do_global_dtors_aux_fini_array_entry

result=$(./test.out __do_global_dtors_aux_fini_array_entry verySecretProgram | grep "__do_global_dtors_aux_fini_array_entry")
expected="__do_global_dtors_aux_fini_array_entry is not a global symbol! :("

if [ "$result" = "$expected" ]; then
    echo "Test 27 passed"
else
    echo "Test 27 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol frame_dummy

result=$(./test.out frame_dummy verySecretProgram | grep "frame_dummy")
expected="frame_dummy is not a global symbol! :("

if [ "$result" = "$expected" ]; then
    echo "Test 28 passed"
else
    echo "Test 28 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol __frame_dummy_init_array_entry

result=$(./test.out __frame_dummy_init_array_entry verySecretProgram | grep "__frame_dummy_init_array_entry")
expected="__frame_dummy_init_array_entry is not a global symbol! :("

if [ "$result" = "$expected" ]; then
    echo "Test 29 passed"
else
    echo "Test 29 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol __FRAME_END__

result=$(./test.out __FRAME_END__ verySecretProgram | grep "__FRAME_END__")
expected="__FRAME_END__ is not a global symbol! :("

if [ "$result" = "$expected" ]; then
    echo "Test 30 passed"
else
    echo "Test 30 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol __GNU_EH_FRAME_HDR

result=$(./test.out __GNU_EH_FRAME_HDR verySecretProgram | grep "__GNU_EH_FRAME_HDR")
expected="__GNU_EH_FRAME_HDR is not a global symbol! :("

if [ "$result" = "$expected" ]; then
    echo "Test 31 passed"
else
    echo "Test 31 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol _GLOBAL_OFFSET_TABLE_

result=$(./test.out _GLOBAL_OFFSET_TABLE_ verySecretProgram | grep "_GLOBAL_OFFSET_TABLE_")
expected="_GLOBAL_OFFSET_TABLE_ is not a global symbol! :("

if [ "$result" = "$expected" ]; then
    echo "Test 32 passed"
else
    echo "Test 32 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol __init_array_end

result=$(./test.out __init_array_end verySecretProgram | grep "__init_array_end")
expected="__init_array_end is not a global symbol! :("

if [ "$result" = "$expected" ]; then
    echo "Test 33 passed"
else
    echo "Test 33 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol __init_array_start

result=$(./test.out __init_array_start verySecretProgram | grep "__init_array_start")
expected="__init_array_start is not a global symbol! :("

if [ "$result" = "$expected" ]; then
    echo "Test 34 passed"
else
    echo "Test 34 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi


# Test the symbol _DYNAMIC

result=$(./test.out _DYNAMIC verySecretProgram | grep "_DYNAMIC")
expected="_DYNAMIC is not a global symbol! :("

if [ "$result" = "$expected" ]; then
    echo "Test 35 passed"
else
    echo "Test 35 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol puts@@GLIBC_2.2.5

result=$(./test.out puts@@GLIBC_2.2.5 verySecretProgram | grep "puts@@GLIBC_2.2.5")
expected="puts@@GLIBC_2.2.5 is a global symbol, but will come from a shared library"

if [ "$result" = "$expected" ]; then
    echo "Test 36 passed"
else
    echo "Test 36 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol __libc_start_main@@GLIBC_2.2.5

result=$(./test.out __libc_start_main@@GLIBC_2.2.5 verySecretProgram | grep "__libc_start_main@@GLIBC_2.2.5")
expected="__libc_start_main@@GLIBC_2.2.5 is a global symbol, but will come from a shared library"

if [ "$result" = "$expected" ]; then
    echo "Test 37 passed"
else
    echo "Test 37 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol __printf_chk@@GLIBC_2.3.4

result=$(./test.out __printf_chk@@GLIBC_2.3.4 verySecretProgram | grep "__printf_chk@@GLIBC_2.3.4")
expected="__printf_chk@@GLIBC_2.3.4 is a global symbol, but will come from a shared library"

if [ "$result" = "$expected" ]; then
    echo "Test 38 passed"
else
    echo "Test 38 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol __isoc99_scanf@@GLIBC_2.7

result=$(./test.out __isoc99_scanf@@GLIBC_2.7 verySecretProgram | grep "__isoc99_scanf@@GLIBC_2.7")
expected="__isoc99_scanf@@GLIBC_2.7 is a global symbol, but will come from a shared library"

if [ "$result" = "$expected" ]; then
    echo "Test 39 passed"
else
    echo "Test 39 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol ShouldNotBeFound

result=$(./test.out ShouldNotBeFound verySecretProgram | grep "ShouldNotBeFound")
expected="ShouldNotBeFound not found!"

if [ "$result" = "$expected" ]; then
    echo "Test 40 passed"
else
    echo "Test 40 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol hw3.c_NotFound

result=$(./test.out hw3.c_NotFound verySecretProgram | grep "hw3.c_NotFound")
expected="hw3.c_NotFound not found!"

if [ "$result" = "$expected" ]; then
    echo "Test 41 passed"
else
    echo "Test 41 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi

# Test the symbol hw3.c_NotFound

result=$(./test.out hw3.c_NotFound test.sh | grep "test.sh")
expected="test.sh not an executable! :("

if [ "$result" = "$expected" ]; then
    echo "Test 42 passed"
else
    echo "Test 42 failed"
    echo "Expected: $expected"
    echo "Got: $result"
fi